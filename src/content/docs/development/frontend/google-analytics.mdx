---
title: Agregar Google Analytics al proyecto
---

import { Aside } from '@astrojs/starlight/components';

<Aside>Este paso debe ser el primero que se realice una vez iniciado el proyecto.</Aside>

Agregar Google Analytics a tu proyecto es un paso importante para poder rastrear y analizar el tráfico de tu sitio web. A continuación, se detallan los pasos necesarios para integrar Google Analytics en los proyectos.

### Crear un Código de Seguimiento en Google Analytics

1. Accede a Google Analytics: Ve a la página de [Google Analytics](https://analytics.google.com/) y accede con la cuenta de la empresa.
2. Crea una Propiedad: Si aún no tienes una propiedad creada, sigue las instrucciones para crear una nueva propiedad.En la url se pone el url del front-end final que podemos obtenerla en la descripción del proyecto en Odoo Esto te proporcionará un código de seguimiento.
3. Obtén el Código de Seguimiento: Una vez que hayas creado la propiedad, busca el código de seguimiento (puede llamarce Measure-ID) que se verá similar a `G-86CGD3473`. Este código es único para tu propiedad y es necesario para la configuración.

<img src="/google-analytics/ga1.png" alt="Google Analytics Image" />

### Configurar Variables de Entorno

1. Abre el archivo **.env**: En la raíz de tu proyecto, busca el archivo **.env**. Si no existe, créalo.
2. Agrega la Variable de Entorno: Añade la siguiente línea, reemplazando **G-9T4MZBPTSP** con el código de seguimiento que obtuviste en el paso anterior:
```js
NEXT_PUBLIC_GA_TRACKING_ID=[COdigo Id Obtenido en google analitic]
```
3. Actualiza el archivo **.env.dist**: Si tu proyecto incluye un archivo **.env.dist**, asegúrate de agregar la misma ​línea en este archivo para que otros desarrolladores también tengan acceso a la variable de entorno.

### Crear la Carpeta y el Componente de Google Analytics

1. Crea una Carpeta para Google Analytics: En la carpeta `componentes`, crea una nueva carpeta llamada `google-analytics`.
2. Copia el Componente: Dentro de la carpeta `google-analytics`, copia el archivo `google-analytics-script-loader.tsx`. Este componente se encargará de cargar el script de Google Analytics en tu aplicación y lo puedes encontrar en el repo de componentes reutilizable sde la empresa
    > google-analytics/google-analytics-script-loader.tsx

```ts
'use client';

import Script from 'next/script';

const GoogleAnalytics = () => {
  return (
    <>
      <Script
        strategy="lazyOnload"
        src={`https://www.googletagmanager.com/gtag/js?id=${process.env.NEXT_PUBLIC_GA_TRACKING_ID}`}
      />

      <Script id="" strategy="lazyOnload">
        {`
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', '${process.env.NEXT_PUBLIC_GA_TRACKING_ID}', {
              page_path: window.location.pathname,
              });
          `}
      </Script>
    </>
  );
};

export default GoogleAnalytics;
```

### Integrar Google Analytics en el Layout

1. Abre el archivo **layout.tsx**: Navega a la carpeta **App** y abre el archivo **layout.tsx**.
2. Agrega el Componente de Google Analytics: Dentro de la etiqueta **html**, agrega la siguiente línea para incluir el componente de Google Analytics:
```ts
   <GoogleAnalytics />
```

```ts
export default async function RootLayout(props: LayoutProps) {
  const params = await props.params;

  const { children } = props;
  const { locale } = params;
  const messages = await getMessages();

  return (
    <html lang={locale} className={classnames(inter.variable, libre.variable)}>
      <GoogleAnalytics /> /* <----- Agregar aquí el componente */
      <body>
        <CookiesProvider>
          <NextIntlClientProvider messages={messages} locale={locale}>
            {children}
          </NextIntlClientProvider>
        </CookiesProvider>
      </body>
    </html>
  );
}
```
3. Importa el Componente**: Asegúrate de importar el componente al inicio del archivo `layout.tsx`:
```ts
import GoogleAnalytics from '../../componentes/google-analytics/google-analytics-script-loader';
```
Una vez que hayas seguido todos estos pasos, Google Analytics estará integrado en tu proyecto y comenzará a rastrear el tráfico de tu sitio web en la pagina en producción. Asegúrate de verificar que los datos se están recopilando correctamente en tu cuenta de Google Analytics.
